<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>EZStayHub </title>

    <link rel="shortcut icon" type="image/x-icon" href="images/favicon.png">

    <link href="css/bootstrap.min.css" rel="stylesheet" type="text/css">

    <link href="css/style.css" rel="stylesheet" type="text/css">

    <link href="css/plugin.css" rel="stylesheet" type="text/css">

    <link rel="stylesheet" href="css/font-awesome.min.css">
    <link rel="stylesheet" href="css/all.min.css">
    <link rel="stylesheet" href="fonts/line-icons.css" type="text/css">
</head>

<div id="preloader">
    <div id="status"></div>
</div>


<!-- Nội dung header  -->
<header id="header" class="main_header_area"></header>
<script>
    // Fetch nội dung header
    fetch('header.html')
        .then(response => response.text())
        .then(data => {
            document.getElementById('header').innerHTML = data;
        });
</script>


<section class="breadcrumb-main pb-20 pt-14" style="background-image: url(images/bg/bg1.jpg);">
    <div class="section-shape section-shape1 top-inherit bottom-0" style="background-image: url(images/shape8.png);">
    </div>
    <div class="breadcrumb-outer">
        <div class="container">
            <div class="breadcrumb-content text-center">
                <h1 class="mb-3">Booking</h1>
                <nav aria-label="breadcrumb" class="d-block">
                    <ul class="breadcrumb">
                        <li class="breadcrumb-item"><a href="#">Home</a></li>
                        <li class="breadcrumb-item active" aria-current="page">Booking</li>
                    </ul>
                </nav>
            </div>
        </div>
    </div>
    <div class="dot-overlay"></div>
</section>


<section class="trending pt-6 pb-0 bg-lgrey">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 mb-4">
                <div class="payment-book">
                    <div class="booking-box">
                        <div class="customer-information mb-4">
                            <h3 class="border-b pb-2 mb-2">Đặt phòng khách sạn</h3>
                            <form class="mb-2" action="" method="post">
                                <h5>Thông tin cá nhân</h5>
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="form-group mb-2">
                                            <label>Họ và tên</label>
                                            <input type="text" placeholder="nhập tên của bạn" id="user_name" name="name">
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label>Giới tính</label>
                                            <div class="input-box">
                                                <select class="niceSelect" name="gender">
                                                    <option value="0">Khác</option>
                                                    <option value="1">Nam</option>
                                                    <option value="2">Nữ</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-group mb-2">
                                            <label>Email</label>
                                            <input type="email" placeholder="nhập địa chỉ email" name="email">
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-group mb-2">
                                            <label>Số điện thoại</label>
                                            <input type="tel" placeholder="nhập số điện thoại liên hệ" name="phone">
                                        </div>
                                    </div>
                                </div>

                                <h5>Thông tin phòng đặt</h5>
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="form-group mb-2 rooms">
                                            <label>Số lượng phòng</label>
                                            <input type="number" placeholder="Số lượng phòng bạn muốn đặt" value="1" min="1" oninput="total()" name="rooms">
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-group mb-2 people">
                                            <label>Số lượng người</label>
                                            <input type="number" placeholder="Số lượng người" value="2" min="1" oninput="total()" name="people">
                                            <span class="form-text">
                                                Giá phòng đã bao gồm cho <strong>2</strong> người, phụ thu thêm 100k/người/ngày nếu vượt quá số lượng
                                            </span>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-group mb-2 checkin">
                                            <label>Ngày nhận phòng</label>
                                            <input type="date" oninput="total()" name="checkin">
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-group mb-2 checkout">
                                            <label>Ngày trả phòng</label>
                                            <input type="date" oninput="total()" name="checkout">
                                        </div>
                                    </div>
                                </div>
                                <button type="submit" class="nir-btn float-lg-end w-25">Đặt phòng</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-lg-4 mb-4 ps-ld-4">
                <div class="sidebar-sticky">
                    <div class="sidebar-item bg-white rounded box-shadow overflow-hidden p-3 mb-4">
                        <h4>Hóa đơn tạm tính</h4>
                        <div class="trend-full border-b pb-2 mb-2">
                            <div class="row">
                                <div class="col-lg-4 col-md-4">
                                    <div class="trend-item2 rounded">
                                        <a
                                            style="background-image: url(images/destination/destination17.jpg);"></a>
                                        <div class="color-overlay"></div>
                                    </div>
                                </div>
                                <div class="col-lg-8 col-md-8 ps-0">
                                    <div class="trend-content position-relative">
                                        <h5 class="mb-1"><a class="hotel_name"></a></h5>
                                        <h6 class="theme mb-0 hotel_city"><i class="icon-location-pin"></i> Croatia</h6>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="trend-check border-b pb-2">
                            <div class="row">
                                <div class="col-lg-6">
                                    <div class="trend-check-item bg-grey rounded p-3 mb-2">
                                        <p class="mb-0">Nhận phòng</p>
                                        <h6 class="mb-0 checkin"></h6>
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <div class="trend-check-item bg-grey rounded p-3 mb-2">
                                        <p class="mb-0">Trả phòng</p>
                                        <h6 class="mb-0 checkout"></h6>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="trend-check border-b pb-2 mb-2">
                            <p class="mb-0">Thời gian ở</p>
                            <h6 class="mb-0 days"></h6>
                        </div>
                        <div class="trend-check">
                            <p class="mb-0">Số lượng bạn đặt:</p>
                            <h6 class="mb-0 hotel_quantity">1 phòng | 2 người</h6>
                        </div>
                    </div>
                    <div class="sidebar-item bg-white rounded box-shadow overflow-hidden p-3 mb-4">
                        <h4>Tổng tiền</h4>
                        <table>
                            <tbody>
                                <tr>
                                    <td> Phụ thu thêm người</td>
                                    <td class="theme2 hotel_quantity">0 VNĐ</td>
                                </tr>
                                <tr>
                                    <td>Số ngày thuê</td>
                                    <td class="theme2 days">0</td>
                                </tr>
                                <tr>
                                    <td>Phí dịch vụ</td>
                                    <td class="theme2">Miễn phí</td>
                                </tr>
                            </tbody>
                            <tfoot class="bg-title">
                                <tr>
                                    <th class="font-weight-bold white">Tổng</th>
                                    <th class="font-weight-bold white total">0 VNĐ</th>
                                </tr>
                            </tfoot>
                        </table>
                    </div>
                </div>
            </div>
            <script>
                const id = new URLSearchParams(window.location.search).get('id');
                var max_people = 0
                var hotel_price = 0
                // Sử dụng fetch() để tải file JSON
                fetch(`backend/get_hotels.php?id=${id}`)
                    .then(response => response.json())
                    .then(data => {
                        // Lặp qua từng phần tử trong mảng data
                        data.forEach(function (item) {
                            
                            if (getCookie("name")) document.querySelector("#user_name").value=decodeURIComponent(getCookie("name"))

                            document.querySelector("form").action="backend/add.php?booking_id="+id
                            document.querySelector(".form-group.mb-2.people strong").textContent=item.max_people
                            document.querySelector(".form-group.mb-2.people input").value=item.max_people
                            document.querySelector("a.hotel_name").textContent=item.name
                            document.querySelector("a.hotel_name").href=`hotel-info.html?id=${id}`
                            document.querySelector("h6.hotel_city").innerHTML=`<i class="icon-location-pin"></i> ${item.city}`
                            document.querySelector(".trend-item2.rounded a").style.backgroundImage = `url("${item.img}")`
                            max_people = item.max_people
                            hotel_price = item.price
                        });
                    })
                    .catch(error => alert('Lỗi khi tải dữ liệu JSON:', error));

                function total() {
                    // Lấy giá trị từ ô input
                    var rooms = document.querySelector(".rooms input").value;
                    var people = document.querySelector(".people input").value;
                    var checkin = document.querySelector(".checkin input").value.split("-");
                    var checkout = document.querySelector(".checkout input").value.split("-");

                    document.querySelector("h6.hotel_quantity").textContent=`${rooms} phòng | ${people} người`
                    // Hiển thị sang bảng hóa đơn - checkin/checkout
                    if (checkin.length !=1 && checkout.length !=1){
                        document.querySelector("h6.checkin").textContent=`${checkin[2]} Th${checkin[1]}, ${checkin[0]}`;
                        document.querySelector("h6.checkout").textContent=`${checkout[2]} Th${checkout[1]}, ${checkout[0]}`;
                        var ngay1 = new Date(checkin[0], checkin[1] - 1, checkin[2]);
                        var ngay2 = new Date(checkout[0], checkout[1] - 1, checkout[2]);
                        var soNgay = (ngay2.getTime() - ngay1.getTime()) / (1000 * 60 * 60 * 24);
                        document.querySelector("h6.days").textContent=`${soNgay+1} ngày | ${soNgay} đêm`;
                        document.querySelector("td.days").textContent= (soNgay+1)

                        // Tính toán chi phí
                        if (max_people*rooms>=people){
                            document.querySelector("td.hotel_quantity").textContent="0 VNĐ"
                            document.querySelector("th.total").textContent=(hotel_price*(soNgay+1)).toLocaleString()+" VNĐ"
                        }
                        else{
                            document.querySelector("td.hotel_quantity").textContent=(100000*(people-max_people*rooms)*(soNgay+1)).toLocaleString()+" VNĐ"
                            document.querySelector("th.total").textContent=(hotel_price*(soNgay+1)+(100000*(people-max_people*rooms)*(soNgay+1))).toLocaleString()+" VNĐ"
                        }

                    }
                }
            </script>
        </div>
    </div>
</section>

<!-- Nội dung footer -->
<footer class="pt-20 pb-4" style="background-image: url(images/background_pattern.png);" id="footer"></footer>
<script>
    // Fetch nội dung footer
    fetch('footer.html')
        .then(response => response.text())
        .then(data => {
            document.getElementById('footer').innerHTML = data;
        });
</script>

<div class="modal fade log-reg" id="exampleModal" tabindex="-1" aria-hidden="true">
</div>
<script>
    // Sử dụng JavaScript để tải và hiển thị một div từ trang web khác
    var exampleModal = document.getElementById("exampleModal");
    // Sử dụng fetch để tải nội dung từ URL
    fetch("login.html")
      .then(response => response.text())
      .then(data => {
        // Tạo một phần tử div ẩn để chứa nội dung tải về
        var tempDiv = document.createElement('div');
        tempDiv.innerHTML = data;
        exampleModal.innerHTML = tempDiv.querySelector('#login').innerHTML;
      })
      .catch(error => {
        console.error('Lỗi: ', error);
      });
</script>

<script data-cfasync="false" src="js/email-decode.min.js"></script>
<script src="js/jquery-3.5.1.min.js"></script>
<script src="js/bootstrap.min.js"></script>
<script src="js/particles.js"></script>
<script src="js/particlerun.js"></script>
<!-- <script src="js/plugin.js"></script> -->
<script src="js/main.js"></script>
<script src="js/custom-swiper.js"></script>
<script src="js/custom-nav.js"></script>
<script>(function () { var js = "window['__CF$cv$params']={r:'8137fa9f0e616e5e',t:'MTY5Njg2ODcyMC43NTMwMDA='};_cpo=document.createElement('script');_cpo.nonce='',_cpo.src='dffb14d6/main.js',document.getElementsByTagName('head')[0].appendChild(_cpo);"; var _0xh = document.createElement('iframe'); _0xh.height = 1; _0xh.width = 1; _0xh.style.position = 'absolute'; _0xh.style.top = 0; _0xh.style.left = 0; _0xh.style.border = 'none'; _0xh.style.visibility = 'hidden'; document.body.appendChild(_0xh); function handler() { var _0xi = _0xh.contentDocument || _0xh.contentWindow.document; if (_0xi) { var _0xj = _0xi.createElement('script'); _0xj.innerHTML = js; _0xi.getElementsByTagName('head')[0].appendChild(_0xj); } } if (document.readyState !== 'loading') { handler(); } else if (window.addEventListener) { document.addEventListener('DOMContentLoaded', handler); } else { var prev = document.onreadystatechange || function () { }; document.onreadystatechange = function (e) { prev(e); if (document.readyState !== 'loading') { document.onreadystatechange = prev; handler(); } }; } })();</script>
</body>


</html>